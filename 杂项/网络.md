## 概述

### 分层体系结构

分层体系结构，各层的所有协议被称为协议栈

因特网的协议栈由 5个层次组成:物理层、链路层、网络层、运输层和应用层

自顶向下看，首先处理应用层，然后向下进行处理。

1. 应用层

**应用层是网络应用程序及它们的应用层协议存留的地方。**HTTP(它提供了Web文档的请求和传送)、SMTP (它提供了电子邮件报文的传输)和FTP (它提供两个端系统之间的文件传送)

2. 传输层

**运输层在应用程序端点之间传送应用层报文。**在因特网中，有两种运输协议，即TCP和UDP,利用其中的任一个都能运输应用层报文。TCP向它的应用程序提供了面向连接的服务。这种服务包括了应用层报文向目的地的确保传递和流量控制(即发送方/接收方速率匹配)。TCP也将长报文划分为短报文，并提供拥塞控制机制，因此当网络拥塞时，源抑制其传输速率。UDP协议向它的应用程序提供无连接服务。这是一种不提供不必要服务的服务，没有可靠性，没有流量控制，也没有拥塞控制。在本书中，我们把运输层的分组称为报文段 (segment) 

3. 网络层

**网络层负责将称为数据报(datagram) 的网络层分组从一台主机移动到另一台主机。**在一台源主机中的因特网运输层协议(TCP或UDP)向网络层递交运输层报文段和目的地址，就像你通过邮政服务寄信件时提供一个目的地址一样。**通常把它简单地称为IP层，这反映了 IP是将因特网连接在一起的黏合剂这样的事实。**

4. 链路层

由链路层提供的服务取决于应用于该链路的特定链路层协议。例如，某些协议基于链路提供可靠传递，从传输节点跨越一条链路到接收节点。值得注意的是，这种可靠的传递服务不同于TCP的可靠传递服务，TCP提供从一个端系统到另一个端系统的可靠交付。链路层的例子包括以太网、WiFi和电缆接入网的DOCSIS协议。因为数据报从源到目的地传送通常需要经过几条链路，一个数据报可能被沿途不同链路上的不同链路层协议处理。例如，一个数据报可能被一段链路上的以太网和下一段链路上的PPP所处理。网络层将受到来自每个不同的链路层协议的不同服务。在本书中，我们把链路层分组称为帧(frame)。

5. 物理层

虽然链路层的任务是将整个帧从一个网络元素移动到邻近的网络元素，而物理层的任务是将该帧中的一个个比特从一个节点移动到下一个节点。在这层中的协议仍然是链路相关的，并且进一步与该链路(例如，双绞铜线、单模光纤)的实际传输媒体相关。例如，以太网具有许多物理层协议:一个是关于双绞铜线的，另一个是关于同轴电缆的，还有一个是关于光纤的，等等。在每种场合中，跨越这些链路移动一个比特是以不同的方式进行的。

### OSI模型

OSI参考模型的7层是:应用层、表示层、会话层、运输层、网络层、数据链路层和物理层

OSI参考模型中附加的两个层，即表示层和会话层。表示层的作用是使通信的应用程序能够解释交换数据的含义。这些服务包括数据压缩和数据加密(它们是自解释的)以及数据描述(这使得应用程序不必担心在各台计算机中表示/ 存储的内部格式不同的问题)。会话层提供了数据交换的定界和同步功能，包括了建立检查点和恢复方案的方法。

因特网缺少了在0SI参考模型中建立的两个层次，该事实引起了一些有趣的问题: 这些层次提供的服务不重要吗？如果一个应用程序需要这些服务之一，将会怎样呢？因特网对这两个问题的回答是相同的:这留给应用程序开发者处理。应用程序开发者决定一个服务是否是重要的，如果该服务重要，应用程序开发者就应该在应用程序中构建该功能。

### 封装

在每一层，一个分组具有两种类型的字段:首部字段和有效载荷字段(payload field)o有效载荷通常是来自上一层的分组。

### 网络攻击

- 自我复制(self-replicating)
- 病毒 (virus)，需要某种形式的用户交互，恶意代码，删除，自我复制，向其他人发送同样的恶意代码
- 蠕虫(worm)，不需要交互

对服务器和网络基础设施的攻击

- 拒绝服务攻击(Denial-of Service ( DoS) attack)
  - 弱点攻击。这涉及向一台目标主机上运行的易受攻击的应用程序或操作系统发送制作精细的报文。如果适当顺序的多个分组发送给一个易受攻击的应用程序或操作系统，该服务器可能停止运行，或者更糟糕的是主机可能崩溃。
  - 带宽洪泛。攻击者向目标主机发送大量的分组，分组数量之多使得目标的接入链路变得拥塞，使得合法的分组无法到达服务器。 
  - 连接洪泛。攻击者在目标主机中创建大量的半开或全开TCP连接。该主机因这些伪造的连接而陷入困境，并停止接受合法的连接。

嗅探分组

接入各种恶意的网络后，它会记录每个流经的分组副本，这个被动接收机称为分组嗅探器(packet sniffer)

伪装

将具有虚假源地址的分组注入因特网的能力被称为IP哄骗(IP spoofing),而它只是一个用户能够冒充另一个用户的许多方式中的一种。

在相互信任的用户之间的通信是一种例外而不是规则

### 问题

“主机”和“端系统”之间有什么不同?列举几种不同类型的端系统。Web服务器是一种端系统吗?

答：没有区别。根据书本内容，“主机”和“终端系统”是交换使用的。



“协议” 一词常被用于描述外交关系。维基百科是怎样描述外交协议的? R3.标准对于协议为什么重要?

答：外交协议常用于描述一系列国家来往规则。这些构建完备和经过时间检验的规则可以使国家和人民生活和工作更简单。协议规则以人民准则为基础，其中的一部分已经作为现在等级地位的声明。标准对于协议来说，可以让人们创建可以相互操作的网络系统和产品。



列出6种接入技术。将它们分类为住宅接入、公司接入或广域无线接入。

答：

a)通过电话线的拨号调制解调器：家庭

b)通过电话线的DSL（Digital Subscriber Line，数字用户线）：家庭或小办公室

c)混合光纤同轴电缆：家庭

d)100M交换以太网：企业

e)无线网：家庭或企业

f)3G和4G：广域无线网



HFC传输速率在用户间是专用的还是共享的?在下行HFC信道中，可能出现碰撞吗?为什么?

答：HFC带宽是由用户共享。下行通道中，所有的包都是由头端这一个单一源发出的。因此，下行通道中没有碰撞。

题目有点多，不想看了

## 应用层

### 进程与计算机网络之间的接口

进程通过一个称为套接字 (socket) 的软件接口向网络发送报文和从网络接收报文。

套接字是同一台主机内应用 层与运输层之间的接口。由于该套接字是建立网络应用程序的可编程接口，因此套接字也称为应用程序和网络之间的应用程序编程接口 (Application Programming Interface, API)。

应用程序开发者可以控制套接字在应用层端的一切，但是对该套接字的运输层端几乎没有控制权。

应用程序开发者对于运输层的控制仅限于:

1. 选择运输层协议;
2. 也许能设定几个运输层参数，如最大缓存和最大报文段长度等(将在第3 章中涉及)。

一旦应用程序开发者选择了一个运输层协议(如果可供选择的话)，则应用程序就建立在由该协议提供的运输层服务之上。

### 进程寻址

为了向特定目的地发送邮政邮件，目的地需要有一个地址。类似地，在一台主机上运 行的进程为了向在另一台主机上运行的进程发送分组，接收进程需要有一个地址。为了标 识该接收进程，需要定义两种信息:

1. 主机的地址。
2. 在目的主机中指定接收进程的标识符。

### 运输服务

- 面向连接的服务:在应用层数据报文开始流动之前，TCP让客户和服务器互相交换运输层控制信息。这个所谓的握手过程提醒客户和服务器，让它们为大量分组的到来做好准备。在握手阶段后，一个TCP连接 (TCP connection)就在两个进程的套接字之间建立了。这条连接是**全双工**的，即连接双方的进程可以在此连接上同时进行报文收发。当应用程序结束报文发送时，必须拆除该连接。
- 可靠的数据传送服务：通信进程能够依靠TCP，无差错、按适当顺序交付所有发 送的数据。当应用程序的一端将字节流传进套接字时，它能够依靠TCP将相同的字节流交付给接收方的套接字，而没有字节的丢失和冗余。

TCP协议还具有拥塞控制机制，这种服务不一定能为通信进程带来直接好处，但能为因特网带来整体好处。当发送方和接收方之间的网络出现拥塞时，TCP的拥塞控制机制会 抑制发送进程(客户或服务器)。

### http

HTTP定义了 Web客户向Web服务器请求Web页面的方式，以及服务器向客户传 送Web页面的方式。

### 非持续链接和持续链接

“三次握手”过程，即客户向服务器发送一个小TCP报文段，服务器用一个小TCP报文段做出确认和响应，最后，客户向服务器返回确认。

往返时间 (Round・Trip Time, RTT)

三次握手中前两个部分所耗费的时间占用了一个RTT。完成了三次握手的前两个部分后，客户结合三次握手的第三部分 (确认) 向该TCP连接发 送一个HTTP请求报文。一旦该请求报文到达服务器，服务器就在该TCP连接上发送 HTML文件。该 HTTP 请求/响应用去了另一个RTT。因此，粗略地讲，总的响应时间就是两个RTT加上服务器传输HTML文件的时间。

### dns

从请求主机到本地 DNS服务器的查询是递归的，其余的查询是迭代的。

#### 缓存

在一个请求链中，当某 DNS 服务器接受一个 DNS 回答时，它将能映射缓存在本地存储器中。

由于主机和主机名 ip 地址之间的映射并不是永久的，DNS 服务器在一段时间后（通常设置为两天）将丢弃缓存的信息。

























































































































































































































## 反向代理

反向代理（reverse proxy）：是指以代理服务器来接受网络请求，并将请求转发给内部的服务器，并且将内部服务器的返回，就像是二房东一样。
一句话解释反向代理 & 正向代理：反向代理隐藏了真正的服务器，正向代理隐藏了真正的客户端。
