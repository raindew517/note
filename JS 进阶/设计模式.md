## 设计模式

- 已验证的解决方案
- 容易被复用
- 富有表达力

> 设计模式是解决软件设计常见问题的可复用方案。--《JavaScript 设计模式》

学习设计模式重要的是学习它的思想和理念，而不是死记硬背具体实现

## 反模式

> 反模式是一种针对某个特定问题的不良解决方案，改方案会导致糟糕的情况发生。 --《JavaScript 设计模式》

- 定义了大量污染全局命名空间的变量
- 修改了 Object 类的原型
- 使用 document.write 创建页面
- 硬编码，写死功能等

## 单例模式

Singleton Pattern 一个类只有一个实例共享使用

**优点**：节约资源，控制入口

**缺点**：拓展困难，不可职责过重

众多设计模式中，**单例模式**比较常见的一种，面试和工作中也会经常接触到。

设计模式经典 GoF 定义的**单例模式**需要满足以下两个条件：

1. 保证一个类**只创建一个实例**
2. 提供对该实例的**全局访问点**

如果在我们应用场景中需要有类似的实体（有且只需要有一个实例，且可全局访问），那么我们就可以使用单例模式将其实现为一个单例对象。

## 适配器模式

Adapter Pattern 不影响现有实现方式，兼容调用旧接口的代码

**优点**：简单、提高复用性

**缺点**：过多使用导致系统层级复杂

### 适配器模式的使用场景

事实上，适配器模式可以说是一种“亡羊补牢”的模式适配器模式，其并不是我们设计之初想要使用到的。

因为如果我们系统和应用原本的接口能够正常工作的话，相信我们并不会使用上适配器模式。然而在业务中，我们经常会发现，对于过去能够好好工作的接口，或许在未来的某一天却发现已经不能适用于新的系统了。此时如果对系统进行重构耗费的精力和时间太大了。

这时候我们就可以考虑**使用适配器模式把旧接口包装成一个新的接口，使它继续保持生命力**。

## 装饰器模式

Decorator Pattern 在不修改原来的接口下，动态地为对象添加功能

优点：拓展对象更灵活，可组合

缺点：添加复杂性

众所周知**装饰器模式**用于给对象在运行期间`动态的`增加功能和职责。相比使用继承的方式来扩充对象的功能，装饰器显得更加灵活。（继承的方式可能会导致子类繁多，如果只是为了增加某一个单一的功能点，就显得有些臃肿了）。

事实上，在过去开发中，我们可能无意中就使用到了装饰器模式，只是我们过去不知道而已。

## 观察者模式

发布者-订阅者模式

优点

- 更加解耦
- 支持广播通信

缺点：大量观察者，广播有性能问题

在我们前端开发中，经常会使用到**观察者模式**，就比如我们习题要实现的自定义事件 `Event`。本题目如果没有做对的同学，需要跟着解析的思路重新做一遍来加深印象。**通过实践来加深对观察者模式的理解**。
当然，也可以看看这个 <https://github.com/aralejs/events> 

## MVC 模式

应用复杂性的提高，程序变得臃肿，难以分工开发

通过**关注点分离**改进程序组织

Model 模型：业务数据

View 视图：用户界面

Controller 控制器：应用逻辑

以前网站开发用的 MVC 模式主要用于服务端，前端就只是负责 view ，后来前端有了拉取数据的能力，且变得更为复杂，前端也有了 MVC 框架 BackboneJS、EmberJS 等

### MVC 数据流回路

我们可以看到 `View`、`Controller` 和 `Model` 三个模块间也有一个类似的的数据流回路：

- 用户与 `View` 交互，触发用户事件；
- 事件被 `Controller` 模块监听到；
- 然后 `Controller` 根据不同的用户事件，调用 `Model` 层相应的接口；
- 接口的调用执行，导致 `Model` 层数据的变化，进而触发相应的数据改变事件；
  事件又被 `View` 模块监听到；
- 最后 `View` 根据新的数据改变自己的状态，完成了这次对用户事件的响应。

![](http://coding.imweb.io/img/p7/mvc-answer.png)

## MVVM 模式

Model-View-ViewModel

从 MVC 模式衍生而来的更适合前端的一种架构模式

优点：双向绑定使 View 和 Model 自动化同步

缺点：不适合简单 UI 界面

最后，在这里引用司徒正美的一段话：
**MVVM让我们换一个视角来看待浏览器的世界，会发现别样的精彩**

## jQuery 中的设计模式

Iterator Pattern 迭代器模式：提供一种方法遍历集合所有的元素且又不宝路该对象的内部表示

Observer Pattern 观察者模式：jQuery 的自定义事件 on trigger off

Composite Pattern 组合模式：描述了一组对象可像单个对象一样的对待 `$('span').addClass('disabled')`

## 结语

- 勿神化设计模式
- 不刻意使用，避免反模式
- 通过实践理解设计模式
- 师傅领进门，修行靠个人